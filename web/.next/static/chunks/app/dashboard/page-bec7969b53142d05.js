(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{4554:(e,t,n)=>{Promise.resolve().then(n.bind(n,5399))},5399:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>j});var i=n(5155),r=n(7058),a=n(2079),s=n(6878),o=n(8237),l=n(2823),d=n(2115),c=n(5572),x=n(6820),p=n(5255),h=n(2800),u=n(6963),m=n(931),g=n(9245),f=n(1616),y=n(9664);function j(){let[e,t]=(0,d.useState)({vaultBalance:0,loanPool:0,activeLoans:0,totalMembers:0}),[n,j]=(0,d.useState)([]),[b,v]=(0,d.useState)(!0);(0,d.useEffect)(()=>{S()},[]);let S=async()=>{try{v(!0);let e=(await (0,r.GG)((0,r.rJ)(y.db,"users"))).size,n=(0,r.P)((0,r.rJ)(y.db,"transactions"),(0,r.My)("date","asc")),i=await (0,r.GG)(n),a=0,s=0,o=0,l=0,d={};i.forEach(e=>{let t=e.data(),n=t.amount||0,i=new Date(t.date).toLocaleString("default",{month:"short",year:"2-digit"});d[i]||(d[i]={contribution:0,loans:0}),"Contribution"===t.type?(a+=n,d[i].contribution+=n):"Loan"===t.type?(s+=n,d[i].loans+=n,l++):"Loan Repayment"===t.type&&(o+=n)});let c=Object.keys(d).map(e=>({name:e,contribution:d[e].contribution,loans:d[e].loans}));t({vaultBalance:a-(s-o),loanPool:s-o,activeLoans:l,totalMembers:e}),j(c)}catch(e){console.error("Error fetching dashboard data:",e)}finally{v(!1)}},C=e=>{let{title:t,value:n,icon:r,color:a}=e;return(0,i.jsxs)("div",{className:"card",style:{padding:"1.5rem",display:"flex",alignItems:"center",gap:"1.25rem"},children:[(0,i.jsx)("div",{style:{backgroundColor:"".concat(a,"15"),color:a,padding:"0.875rem",borderRadius:"1rem"},children:(0,i.jsx)(r,{size:24})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{style:{fontSize:"0.75rem",fontWeight:"700",color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:"0.5px"},children:t}),(0,i.jsx)("p",{style:{fontSize:"1.25rem",fontWeight:"800",color:"var(--text-primary)",marginTop:"0.25rem"},children:n})]})]})};return(0,i.jsxs)(f.A,{children:[(0,i.jsxs)("div",{style:{marginBottom:"2.5rem"},children:[(0,i.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"900",letterSpacing:"-0.5px"},children:"Dashboard Overview"}),(0,i.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Societies financial performance tracking"})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:"1.5rem",marginBottom:"2.5rem"},children:[(0,i.jsx)(C,{title:"Vault Balance",value:"TSh ".concat(e.vaultBalance.toLocaleString()),icon:a.A,color:"#10B981"}),(0,i.jsx)(C,{title:"Loan Pool (Owed)",value:"TSh ".concat(e.loanPool.toLocaleString()),icon:s.A,color:"#F57C00"}),(0,i.jsx)(C,{title:"Active Loans",value:e.activeLoans,icon:o.A,color:"#3B82F6"}),(0,i.jsx)(C,{title:"Total Members",value:e.totalMembers,icon:l.A,color:"#8B5CF6"})]}),(0,i.jsxs)("div",{className:"card",style:{padding:"2rem",marginBottom:"2.5rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"800"},children:"Inflow vs Outflow"}),(0,i.jsx)("p",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Comparing Monthly Contributions and Loans issued"})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem",fontWeight:"700"},children:[(0,i.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"4px",backgroundColor:"#F57C00"}}),(0,i.jsx)("span",{children:"Contributions"})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem",fontWeight:"700"},children:[(0,i.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"4px",backgroundColor:"#CBD5E1"}}),(0,i.jsx)("span",{children:"Loans"})]})]})]}),(0,i.jsx)("div",{style:{width:"100%",height:400},children:(0,i.jsx)(c.u,{children:(0,i.jsxs)(x.E,{data:n,children:[(0,i.jsx)(p.d,{strokeDasharray:"3 3",vertical:!1,stroke:"#E2E8F0"}),(0,i.jsx)(h.W,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12},dy:10}),(0,i.jsx)(u.h,{axisLine:!1,tickLine:!1,tick:{fill:"#64748B",fontSize:12},tickFormatter:e=>"TSh ".concat(e/1e3,"k")}),(0,i.jsx)(m.m,{cursor:{fill:"rgba(245, 124, 0, 0.05)"},contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgba(0,0,0,0.1)",padding:"12px"},formatter:(e,t)=>["TSh ".concat(e.toLocaleString()),"contribution"===t?"Total Contribution":"Loans Issued"]}),(0,i.jsx)(g.yP,{dataKey:"contribution",name:"contribution",fill:"#F57C00",radius:[6,6,0,0],barSize:30}),(0,i.jsx)(g.yP,{dataKey:"loans",name:"loans",fill:"#CBD5E1",radius:[6,6,0,0],barSize:30})]})})})]})]})}},1616:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var i=n(5155),r=n(6046),a=n(2115),s=n(9584),o=n(858),l=n(2823),d=n(2060),c=n(6967),x=n(3518),p=n(5236),h=n(8173),u=n.n(h),m=n(9664);function g(e){let{isMinimized:t,setIsMinimized:n}=e,a=(0,r.usePathname)(),s=[{name:"Dashboard",href:"/dashboard",icon:o.A},{name:"Members",href:"/members",icon:l.A},{name:"Transactions",href:"/transactions",icon:d.A}];return(0,i.jsxs)("div",{style:{width:t?"80px":"260px",height:"100vh",backgroundColor:"#1E293B",color:"white",transition:"width 0.3s ease",display:"flex",flexDirection:"column",position:"fixed",left:0,top:0,zIndex:50},children:[(0,i.jsxs)("div",{style:{height:"80px",padding:"0 24px",display:"flex",alignItems:"center",justifyContent:t?"center":"space-between"},children:[!t&&(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,i.jsx)("div",{style:{width:"32px",height:"32px",backgroundColor:"#F57C00",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(d.A,{size:20,color:"white"})}),(0,i.jsx)("h2",{style:{fontSize:"16px",fontWeight:"900",letterSpacing:"1px"},children:"KIKOBA"})]}),(0,i.jsx)("button",{onClick:()=>n(!t),style:{padding:"8px",borderRadius:"8px",backgroundColor:"rgba(255,255,255,0.05)",color:"#94A3B8"},children:t?(0,i.jsx)(c.A,{size:18}):(0,i.jsx)(x.A,{size:18})})]}),(0,i.jsx)("nav",{style:{flex:1,padding:"12px"},children:s.map(e=>{let n=a===e.href;return(0,i.jsxs)(u(),{href:e.href,style:{display:"flex",alignItems:"center",padding:"14px 16px",marginBottom:"8px",borderRadius:"12px",textDecoration:"none",color:n?"white":"#94A3B8",backgroundColor:n?"#F57C00":"transparent",justifyContent:t?"center":"flex-start",transition:"all 0.2s",boxShadow:n?"0 4px 12px rgba(245, 124, 0, 0.3)":"none"},children:[(0,i.jsx)(e.icon,{size:20,style:{marginRight:t?0:"12px"}}),!t&&(0,i.jsx)("span",{style:{fontWeight:"600",fontSize:"14px"},children:e.name})]},e.href)})}),(0,i.jsx)("div",{style:{padding:"12px",borderTop:"1px solid rgba(255,255,255,0.05)"},children:(0,i.jsxs)("button",{onClick:()=>{m.j.signOut()},style:{display:"flex",alignItems:"center",width:"100%",padding:"14px 16px",borderRadius:"12px",color:"#F43F5E",justifyContent:t?"center":"flex-start",transition:"all 0.2s"},children:[(0,i.jsx)(p.A,{size:20,style:{marginRight:t?0:"12px"}}),!t&&(0,i.jsx)("span",{style:{fontWeight:"600",fontSize:"14px"},children:"Logout"})]})})]})}function f(e){let{children:t}=e,{user:n,role:o,loading:l}=(0,s.A)(),d=(0,r.useRouter)(),[c,x]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{l||n&&"Admin"===o||d.replace("/")},[n,o,l,d]),l||!n||"Admin"!==o)?(0,i.jsx)("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)("p",{children:"Loading Admin Dashboard..."})}):(0,i.jsxs)("div",{style:{display:"flex"},children:[(0,i.jsx)(g,{isMinimized:c,setIsMinimized:x}),(0,i.jsx)("main",{style:{flex:1,marginLeft:c?"80px":"260px",minHeight:"100vh",backgroundColor:"var(--background-muted)",transition:"margin-left 0.3s ease"},children:(0,i.jsx)("div",{style:{padding:"2.5rem"},children:t})})]})}},9584:(e,t,n)=>{"use strict";n.d(t,{A:()=>c,AuthProvider:()=>d});var i=n(5155),r=n(12),a=n(7058),s=n(2115),o=n(9664);let l=(0,s.createContext)({user:null,role:null,loading:!0});function d(e){let{children:t}=e,[n,d]=(0,s.useState)(null),[c,x]=(0,s.useState)(null),[p,h]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=(0,r.hg)(o.j,async e=>{if(e){h(!0),d(e);try{let t=await (0,a.x7)((0,a.H9)(o.db,"users",e.uid));t.exists()&&x(t.data().role||"Member")}catch(e){console.error("Error fetching user role:",e)}h(!1)}else d(null),x(null),h(!1)});return()=>e()},[]),(0,i.jsx)(l.Provider,{value:{user:n,role:c,loading:p},children:t})}let c=()=>(0,s.useContext)(l)},9664:(e,t,n)=>{"use strict";n.d(t,{db:()=>l,j:()=>o});var i=n(9904),r=n(12),a=n(7058);let s=(0,i.Dk)().length>0?(0,i.Sx)():(0,i.Wp)({apiKey:"AIzaSyBWBs-DPjFFpVjm_Kcna5PE5Jf_L7DofH8",authDomain:"kikoba-app-28064.firebaseapp.com",projectId:"kikoba-app-28064",storageBucket:"kikoba-app-28064.firebasestorage.app",messagingSenderId:"496818688394",appId:"1:496818688394:web:61b33f4aede1cf3a9cb873"}),o=(0,r.xI)(s),l=(0,a.aU)(s)}},e=>{var t=t=>e(e.s=t);e.O(0,[135,497,963,330,250,441,517,358],()=>t(4554)),_N_E=e.O()}]);